#lang racket
(require racket/string)
(require minikanren)

(require simple-xlsx)
(require racket/format)
(require racket/date)


    
(define sched '((((matanlec1 Иванов 4аудитория) (matanlec2 Иванов 4аудитория) (alglec Петров 4аудитория) (geomlec Васечкин 4аудитория))
   ((inflec 4препод 4аудитория) (difflec 4препод 4аудитория) (geom1 преп3 4аудитория) _.0)
   (_.1 (matan1 преп1 4аудитория) (diff1 преп4 4аудитория) _.2)
   (_.3 (matan2 преп1 4аудитория) (prog1 преп5 4аудитория) _.4)
   (_.5 (alg1 преп2 4аудитория) (eng1 преп6 4аудитория) _.6))
  (((matanlec1 Иванов 4аудитория) (matanlec2 Иванов 4аудитория) (alglec Петров 4аудитория) (geomlec Васечкин 4аудитория))
   ((inflec 4препод 4аудитория) (difflec 4препод 4аудитория) _.7 (matan1 преп1 4аудитория))
   ((diff1 преп4 4аудитория) _.8 _.9 (matan2 преп1 4аудитория))
   ((prog1 преп5 4аудитория) _.10 _.11 (alg1 преп2 4аудитория))
   ((eng1 преп6 4аудитория) _.12 _.13 (geom1 преп3 4аудитория)))
  (((matanlec1 Иванов 4аудитория) (matanlec2 Иванов 4аудитория) (alglec Петров 4аудитория) (geomlec Васечкин 4аудитория))
   ((inflec 4препод 4аудитория) (difflec 4препод 4аудитория) _.14 _.15)
   (_.16 (alg1 преп2 3аудитория) (matan2 преп1 3аудитория) (eng1 преп6 3аудитория))
   (_.17 (geom1 преп3 3аудитория) (diff1 преп4 3аудитория) _.18)
   (_.19 (matan1 преп1 3аудитория) (prog1 преп5 3аудитория) _.20))
  (((matanlec1 Иванов 4аудитория) (matanlec2 Иванов 4аудитория) (alglec Петров 4аудитория) (geomlec Васечкин 4аудитория))
   ((inflec 4препод 4аудитория) (difflec 4препод 4аудитория) (matan1 преп1 2аудитория) _.21)
   ((prog1 преп5 3аудитория) _.22 _.23 _.24)
   ((eng1 преп6 3аудитория) _.25 (matan2 преп1 2аудитория) (geom1 преп3 3аудитория))
   ((diff1 преп4 3аудитория) _.26 _.27 (alg1 преп2 3аудитория)))
  (((alglec Петров 3аудитория) (geomlec Васечкин 3аудитория) (matanlec1 Иванов 3аудитория) (matanlec2 Иванов 3аудитория))
   (_.28 (matan1 преп1 2аудитория) (inflec 4препод 3аудитория) (difflec 4препод 3аудитория))
   (_.29 (geom1 преп3 2аудитория) (prog1 преп5 2аудитория) _.30)
   (_.31 (alg1 преп2 2аудитория) _.32 (eng1 преп6 2аудитория))
   (_.33 (diff1 преп4 2аудитория) (matan2 преп1 2аудитория) _.34))
  (((alglec Петров 3аудитория) (geomlec Васечкин 3аудитория) (matanlec1 Иванов 3аудитория) (matanlec2 Иванов 3аудитория))
   ((matan2 преп1 2аудитория) (eng1 преп6 3аудитория) (inflec 4препод 3аудитория) (difflec 4препод 3аудитория))
   ((geom1 преп3 2аудитория) _.35 _.36 (alg1 преп2 2аудитория))
   ((diff1 преп4 2аудитория) _.37 _.38 _.39)
   ((prog1 преп5 2аудитория) _.40 _.41 (matan1 преп1 2аудитория)))
  (((alglec Петров 3аудитория) (geomlec Васечкин 3аудитория) (matanlec1 Иванов 3аудитория) (matanlec2 Иванов 3аудитория))
   (_.42 (alg1 преп2 1аудитория) (inflec 4препод 3аудитория) (difflec 4препод 3аудитория))
   ((matan2 преп1 1аудитория) (diff1 преп4 1аудитория) (eng1 преп6 1аудитория) _.43)
   (_.44 (prog1 преп5 1аудитория) _.45 (matan1 преп1 1аудитория))
   (_.46 (geom1 преп3 1аудитория) _.47 _.48))
  (((alglec Петров 3аудитория) (geomlec Васечкин 3аудитория) (matanlec1 Иванов 3аудитория) (matanlec2 Иванов 3аудитория))
   ((eng1 преп6 1аудитория) _.49 (inflec 4препод 3аудитория) (difflec 4препод 3аудитория))
   (_.50 _.51 _.52 (diff1 преп4 1аудитория))
   ((matan1 преп1 1аудитория) _.53 (alg1 преп2 1аудитория) _.54)
   ((matan2 преп1 1аудитория) _.55 (geom1 преп3 1аудитория) (prog1 преп5 1аудитория)))
  (((matanlec1 4аудитория matobes1) (matanlec2 4аудитория matobes1) (matanlec1 3аудитория matobes2) (matanlec2 3аудитория matobes2))
   (_.56 _.57 _.58 _.59)
   (_.60 _.61 _.62 _.63)
   (_.64 _.65 _.66 _.67)
   (_.68 _.69 _.70 _.71))
  (((alglec 3аудитория matobes2) _.72 (alglec 4аудитория matobes1) _.73)
   (_.74 (alg1 группа7 1аудитория) _.75 _.76)
   (_.77 (alg1 группа3 3аудитория) _.78 (alg1 группа6 2аудитория))
   (_.79 (alg1 группа5 2аудитория) (alg1 группа8 1аудитория) (alg1 группа2 4аудитория))
   (_.80 (alg1 группа1 4аудитория) _.81 (alg1 группа4 3аудитория)))
  ((_.82 (geomlec 3аудитория matobes2) _.83 (geomlec 4аудитория matobes1))
   (_.84 _.85 (geom1 группа1 4аудитория) _.86)
   ((geom1 группа6 2аудитория) (geom1 группа5 2аудитория) _.87 _.88)
   (_.89 (geom1 группа3 3аудитория) _.90 (geom1 группа4 3аудитория))
   (_.91 (geom1 группа7 1аудитория) (geom1 группа8 1аудитория) (geom1 группа2 4аудитория)))
  ((_.92 _.93 _.94 _.95)
   ((inflec 4аудитория matobes1) (difflec 4аудитория matobes1) (inflec 3аудитория matobes2) (difflec 3аудитория matobes2))
   ((diff1 группа2 4аудитория) (diff1 группа7 1аудитория) (diff1 группа1 4аудитория) (diff1 группа8 1аудитория))
   ((diff1 группа6 2аудитория) _.96 (diff1 группа3 3аудитория) _.97)
   ((diff1 группа4 3аудитория) (diff1 группа5 2аудитория) _.98 _.99))
  ((_.100 _.101 _.102 _.103)
   ((matan2 группа6 2аудитория) (matan1 группа5 2аудитория) (matan1 группа4 2аудитория) (matan1 группа2 4аудитория))
   ((matan2 группа7 1аудитория) (matan1 группа1 4аудитория) (matan2 группа3 3аудитория) (matan2 группа2 4аудитория))
   ((matan1 группа8 1аудитория) (matan2 группа1 4аудитория) (matan2 группа4 2аудитория) (matan1 группа7 1аудитория))
   ((matan2 группа8 1аудитория) (matan1 группа3 3аудитория) (matan2 группа5 2аудитория) (matan1 группа6 2аудитория)))
  ((_.104 _.105 _.106 _.107)
   (_.108 _.109 _.110 _.111)
   ((prog1 группа4 3аудитория) _.112 (prog1 группа5 2аудитория) _.113)
   ((prog1 группа2 4аудитория) (prog1 группа7 1аудитория) (prog1 группа1 4аудитория) _.114)
   ((prog1 группа6 2аудитория) _.115 (prog1 группа3 3аудитория) (prog1 группа8 1аудитория)))
  ((_.116 _.117 _.118 _.119)
   ((eng1 группа8 1аудитория) (eng1 группа6 3аудитория) _.120 _.121)
   (_.122 _.123 (eng1 группа7 1аудитория) (eng1 группа3 3аудитория))
   ((eng1 группа4 3аудитория) _.124 _.125 (eng1 группа5 2аудитория))
   ((eng1 группа2 4аудитория) _.126 (eng1 группа1 4аудитория) _.127))
  ((_.128 _.129 _.130 _.131) (_.132 _.133 _.134 _.135) (_.136 _.137 _.138 _.139) (_.140 _.141 _.142 _.143) (_.144 _.145 _.146 _.147))
  ((_.148 _.149 _.150 _.151) (_.152 _.153 _.154 _.155) (_.156 _.157 _.158 _.159) (_.160 _.161 _.162 _.163) (_.164 _.165 _.166 _.167))
  ((_.168 _.169 _.170 _.171)
   ((eng1 преп6 группа8) (alg1 преп2 1аудитория) _.172 _.173)
   ((matan2 преп1 группа7) (diff1 преп4 1аудитория) (eng1 преп6 1аудитория) (diff1 преп4 1аудитория))
   ((matan1 преп1 группа8) (prog1 преп5 1аудитория) (alg1 преп2 1аудитория) (matan1 преп1 1аудитория))
   ((matan2 преп1 группа8) (geom1 преп3 1аудитория) (geom1 преп3 1аудитория) (prog1 преп5 1аудитория)))
  ((_.174 _.175 _.176 _.177)
   ((matan2 преп1 группа6) (matan1 преп1 2аудитория) (matan1 преп1 2аудитория) _.178)
   ((geom1 преп3 группа6) (geom1 преп3 2аудитория) (prog1 преп5 2аудитория) (alg1 преп2 2аудитория))
   ((diff1 преп4 группа6) (alg1 преп2 2аудитория) (matan2 преп1 2аудитория) (eng1 преп6 2аудитория))
   ((prog1 преп5 группа6) (diff1 преп4 2аудитория) (matan2 преп1 2аудитория) (matan1 преп1 2аудитория)))
  (((alglec Петров 3аудитория) (geomlec Васечкин 3аудитория) (matanlec1 Иванов 3аудитория) (matanlec2 Иванов 3аудитория))
   (_.179 (eng1 преп6 3аудитория) (inflec 4препод 3аудитория) (difflec 4препод 3аудитория))
   ((prog1 преп5 группа4) (alg1 преп2 3аудитория) (matan2 преп1 3аудитория) (eng1 преп6 3аудитория))
   ((eng1 преп6 группа4) (geom1 преп3 3аудитория) (diff1 преп4 3аудитория) (geom1 преп3 3аудитория))
   ((diff1 преп4 группа4) (matan1 преп1 3аудитория) (prog1 преп5 3аудитория) (alg1 преп2 3аудитория)))
  (((matanlec1 Иванов 4аудитория) (matanlec2 Иванов 4аудитория) (alglec Петров 4аудитория) (geomlec Васечкин 4аудитория))
   ((inflec 4препод 4аудитория) (difflec 4препод 4аудитория) (geom1 преп3 4аудитория) (matan1 преп1 4аудитория))
   ((diff1 преп4 группа2) (matan1 преп1 4аудитория) (diff1 преп4 4аудитория) (matan2 преп1 4аудитория))
   ((prog1 преп5 группа2) (matan2 преп1 4аудитория) (prog1 преп5 4аудитория) (alg1 преп2 4аудитория))
   ((eng1 преп6 группа2) (alg1 преп2 4аудитория) (eng1 преп6 4аудитория) (geom1 преп3 4аудитория)))
  ((_.180 _.181 _.182 _.183) (_.184 _.185 _.186 _.187) (_.188 _.189 _.190 _.191) (_.192 _.193 _.194 _.195) (_.196 _.197 _.198 _.199))))


(let ([xlsx (new xlsx%)]
     [sheet_data
      (map (lambda(i) (map ~a (append* i))) sched)
     
                   ])

 (send xlsx add-data-sheet #:sheet_name "DataSheet" #:sheet_data sheet_data)


(write-xlsx-file xlsx "Sched.xlsx"));

